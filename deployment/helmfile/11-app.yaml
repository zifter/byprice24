{{ readFile "defaults.yaml" }}

commonLabels:
  tier: "app"

releases:
  - name: cms
    namespace: {{ .Values.namespace }}
    chart: ../charts/cms
    timeout: 180
    labels:
      side: "backend"
    values:
      - releases/backend/values.yaml.gotmpl
      - releases/backend/cms/values.yaml
      - releases/backend/values-{{ .Environment.Name }}.yaml
      - releases/backend/cms/values-{{ .Environment.Name }}.yaml

  - name: worker-crawler
    namespace: {{ .Values.namespace }}
    chart: ../charts/worker
    labels:
      side: "backend"
    values:
      - releases/backend/values.yaml.gotmpl
      - releases/backend/worker/values.yaml
      - releases/backend/worker/values-crawler.yaml
      - releases/backend/values-{{ .Environment.Name }}.yaml

  - name: worker-etc
    namespace: {{ .Values.namespace }}
    chart: ../charts/worker
    labels:
      side: "backend"
    values:
      - releases/backend/values.yaml.gotmpl
      - releases/backend/worker/values.yaml
      - releases/backend/worker/values-etc.yaml
      - releases/backend/values-{{ .Environment.Name }}.yaml

  # Frontend
  - name: site
    namespace: {{ .Values.namespace }}
    chart: ../charts/site
    labels:
      side: "frontend"
    values:
      - releases/frontend/values.yaml
      - releases/frontend/values-{{ .Environment.Name }}.yaml
      - image:
          tag: {{ .Values.app.frontend }}
